module.exports=[38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},49846,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(10849),e=a.i(50944),f=a.i(38246);function g(){let[a,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)("What's missing from the kitchen?"),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)("splurge"),[D,E]=(0,c.useState)(!1),F=(0,c.useRef)(null),G=(0,e.useRouter)(),H=(0,e.useSearchParams)();(0,c.useEffect)(()=>{I()},[]),(0,c.useEffect)(()=>{"1"!==H.get("connectKroger")||j?.connected||u("Connect your Kroger account to start adding items to your cart.")},[H,j?.connected]);let I=async()=>{if(!(0,d.isSupabaseConfigured)()||!d.supabase)return void i(!1);let{data:{user:a}}=await d.supabase.auth.getUser();a?(g(a),J(a.id),K(a.id),L(a.id),i(!1)):G.push("/login")},J=async a=>{try{w(!0);let b=await fetch(`/api/kroger/status?userId=${a}`),c=await b.json();k(c),c.connected||u("Let's connect your Kroger account first â€” just takes a moment.")}catch(a){console.error("Failed to check Kroger status:",a)}finally{w(!1)}},K=async a=>{try{A(!0);let b=await fetch(`/api/memory/usuals?userId=${a}`),c=await b.json();Array.isArray(c.usuals)&&y(c.usuals.map(a=>a.term))}catch(a){console.error("Failed to fetch usuals:",a)}finally{A(!1)}},L=async a=>{try{let b=await fetch(`/api/memory/settings?userId=${a}`),c=await b.json();("budget"===c.shopping_mode||"splurge"===c.shopping_mode)&&C(c.shopping_mode)}catch(a){console.error("Failed to fetch settings:",a)}},M=async b=>{if(a){E(!0);try{let c=await fetch("/api/memory/settings",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.id,shopping_mode:b})}),d=await c.json();d.shopping_mode&&C(d.shopping_mode)}catch(a){console.error("Failed to update mode:",a)}finally{E(!1)}}},N=async()=>{if(!a)return;let b=await fetch(`/api/kroger/auth-url?userId=${a.id}`),c=await b.json();c.url&&(window.location.href=c.url)},O=()=>{n.trim()&&!l.includes(n.trim())&&(m([...l,n.trim()]),o(""),u(`Got it â€” ${n.trim()}. What else?`),F.current?.focus())},P=async()=>{if(a&&0!==l.length){q(!0),s(null),u("Finding your items and adding them to the cart...");try{let b=await fetch("/api/kroger/add-to-cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.id,items:l,shopping_mode:B})}),c=await b.json();s(c),c.success?(m([]),u("All done! Your cart is ready for checkout. ðŸ«’"),K(a.id)):c.needsAuth?u("Please connect your Kroger account to continue."):u(c.error||"Something went wrong. Let's try again.")}catch(a){s({error:a.message}),u("I couldn't reach Kroger. Let's try again in a moment.")}finally{q(!1)}}},Q=async()=>{d.supabase&&(await d.supabase.auth.signOut(),G.push("/"))};return h?(0,b.jsx)("div",{className:"min-h-screen bg-[#fdfcf9] flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-12 h-12 bg-[#9caf88] rounded-full flex items-center justify-center olive-pulse",children:(0,b.jsx)("span",{className:"text-white text-xl",children:"ðŸ«’"})})}):(0,d.isSupabaseConfigured)()?(0,b.jsxs)("main",{className:"min-h-screen bg-[#fdfcf9]",children:[(0,b.jsx)("header",{className:"bg-white/80 backdrop-blur-sm border-b border-[#eef2e6] sticky top-0 z-10",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-3 flex justify-between items-center",children:[(0,b.jsxs)(f.default,{href:"/dashboard",className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-[#9caf88] rounded-full flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white text-sm",children:"ðŸ«’"})}),(0,b.jsx)("span",{className:"text-lg font-medium text-[#3a4529]",children:"Olive"})]}),(0,b.jsx)("button",{onClick:Q,className:"text-[#87a05a] hover:text-[#6b8245] text-sm",children:"Sign Out"})]})}),(0,b.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"text-center mb-8 fade-in",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-[#9caf88] rounded-full flex items-center justify-center mx-auto mb-4 olive-pulse",children:(0,b.jsx)("span",{className:"text-white text-2xl",children:"ðŸ«’"})}),(0,b.jsx)("p",{className:"text-[#2d3a1f] text-lg",children:t})]}),(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-5 border border-[#eef2e6] shadow-sm mb-6",children:[(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium mb-3 text-sm",children:"How should Olive pick items?"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("button",{onClick:()=>M("splurge"),disabled:D,className:`rounded-2xl p-4 text-left border-2 transition ${"splurge"===B?"border-[#9caf88] bg-[#f8faf5]":"border-[#eef2e6] bg-white hover:border-[#dce5cc]"}`,children:[(0,b.jsx)("span",{className:"block text-lg mb-1",children:"ðŸ«’"}),(0,b.jsx)("span",{className:"font-medium text-[#2d3a1f] text-sm",children:"Your preferences"}),(0,b.jsx)("span",{className:"block text-[#87a05a] text-xs mt-1",children:"Your usual brands & picks"})]}),(0,b.jsxs)("button",{onClick:()=>M("budget"),disabled:D,className:`rounded-2xl p-4 text-left border-2 transition ${"budget"===B?"border-[#9caf88] bg-[#f8faf5]":"border-[#eef2e6] bg-white hover:border-[#dce5cc]"}`,children:[(0,b.jsx)("span",{className:"block text-lg mb-1",children:"ðŸ·ï¸"}),(0,b.jsx)("span",{className:"font-medium text-[#2d3a1f] text-sm",children:"Best deals"}),(0,b.jsx)("span",{className:"block text-[#87a05a] text-xs mt-1",children:"Lowest price from search"})]})]})]}),!j?.connected&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-6 border border-[#eef2e6] shadow-sm mb-6 fade-in",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-[#eef2e6] rounded-2xl flex items-center justify-center text-xl",children:"ðŸ”—"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium",children:"Connect Kroger"}),(0,b.jsx)("p",{className:"text-[#87a05a] text-sm",children:"One-time setup to link your account"})]}),(0,b.jsx)("button",{onClick:N,className:"bg-[#9caf88] text-white px-5 py-2.5 rounded-xl hover:bg-[#87a05a] transition text-sm font-medium",children:"Connect"})]}),(0,b.jsx)("p",{className:"text-[#87a05a] text-xs mt-3",children:"Olive only builds your cart â€” you still review and place the order."})]}),(0,b.jsx)("div",{className:"bg-white rounded-3xl p-4 border border-[#eef2e6] shadow-sm mb-6",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{ref:F,type:"text",value:n,onChange:a=>o(a.target.value),onKeyPress:a=>"Enter"===a.key&&O(),placeholder:"milk, eggs, bread...",className:"flex-1 px-4 py-3 bg-[#f8faf5] border border-[#dce5cc] rounded-xl focus:ring-2 focus:ring-[#9caf88] focus:border-transparent outline-none transition text-[#2d3a1f]"}),(0,b.jsx)("button",{onClick:O,className:"bg-[#9caf88] text-white px-5 py-3 rounded-xl hover:bg-[#87a05a] transition font-medium",children:"Add"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[(0,b.jsxs)("div",{className:"col-span-2 bg-white rounded-3xl p-5 border border-[#eef2e6] shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)("span",{className:"text-lg",children:"ðŸ›’"}),(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium",children:"Current Haul"}),l.length>0&&(0,b.jsxs)("span",{className:"ml-auto text-sm text-[#87a05a]",children:[l.length," items"]})]}),l.length>0?(0,b.jsx)("ul",{className:"space-y-2",children:l.map((a,c)=>(0,b.jsxs)("li",{className:"flex justify-between items-center bg-[#f8faf5] px-4 py-2.5 rounded-xl group",children:[(0,b.jsx)("span",{className:"text-[#2d3a1f]",children:a}),(0,b.jsx)("button",{onClick:()=>{m(l.filter(b=>b!==a)),1===l.length&&u("List is empty. What do we need?")},className:"text-[#c4704b] opacity-0 group-hover:opacity-100 transition text-sm",children:"remove"})]},c))}):(0,b.jsx)("p",{className:"text-[#87a05a] text-center py-6 text-sm",children:"Your list is empty â€” add something above"})]}),r&&(0,b.jsxs)("div",{className:`rounded-3xl p-5 border ${r.success?"bg-[#eef2e6] border-[#dce5cc]":"bg-[#fff7ed] border-[#fed7aa]"}`,children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:r.success?"âœ“":"âš ï¸"}),(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium text-sm",children:r.success?"Added to Cart":"Needs attention"}),r.success&&r.shopping_mode_used&&(0,b.jsx)("p",{className:"text-[#87a05a] text-xs mt-1",children:"budget"===r.shopping_mode_used?"Best deals":"Your preferences"}),r.success?(0,b.jsx)("a",{href:r.cartUrl||"https://www.kroger.com/shopping/cart",target:"_blank",rel:"noopener noreferrer",className:"text-[#6b8245] text-sm hover:underline mt-2 inline-block",children:"Open Cart â†’"}):(0,b.jsx)("p",{className:"text-[#9a3412] text-xs mt-2",children:r.error||"Some items could not be added."})]}),v?(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-5 border border-[#eef2e6] shadow-sm",children:[(0,b.jsx)("div",{className:"h-6 w-6 bg-[#eef2e6] rounded-full mb-3"}),(0,b.jsx)("div",{className:"h-3 w-24 bg-[#eef2e6] rounded mb-2"}),(0,b.jsx)("div",{className:"h-2 w-16 bg-[#f1f5ec] rounded"})]}):j?.connected&&(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-5 border border-[#eef2e6] shadow-sm",children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:"âœ“"}),(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium text-sm",children:"Kroger Connected"}),(0,b.jsx)("p",{className:"text-[#87a05a] text-xs",children:"Ready to shop"})]})]}),l.length>0&&j?.connected&&(0,b.jsx)("button",{onClick:P,disabled:p,className:"w-full bg-[#9caf88] text-white py-4 rounded-2xl hover:bg-[#87a05a] transition disabled:opacity-50 font-medium text-lg shadow-sm",children:p?(0,b.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,b.jsx)("span",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Adding to Kroger..."]}):`Add ${l.length} item${l.length>1?"s":""} to Kroger Cart`}),r?.results&&(0,b.jsxs)("div",{className:"mt-6 bg-white rounded-3xl p-5 border border-[#eef2e6] shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[#2d3a1f] font-medium mb-3 text-sm",children:"Item results"}),(0,b.jsx)("div",{className:"space-y-2 text-sm",children:r.results.map(a=>(0,b.jsxs)("div",{className:`flex items-center justify-between px-3 py-2 rounded-xl ${a.found?"bg-[#f8faf5]":"bg-[#fff7ed]"}`,children:[(0,b.jsx)("span",{className:"text-[#2d3a1f]",children:a.term}),(0,b.jsx)("span",{className:`text-xs ${a.found?"text-[#6b8245]":"text-[#9a3412]"}`,children:a.found?"Added":"Not found"})]},a.term))})]}),(0,b.jsxs)("div",{className:"mt-8 pt-6 border-t border-[#eef2e6]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-3 text-[#87a05a] text-sm",children:[(0,b.jsx)("span",{children:"Quick add"}),z&&(0,b.jsx)("span",{className:"text-xs",children:"â€¢ loading usuals"})]}),(0,b.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:[...new Set([...x,"Milk","Eggs","Bread","Bananas","Butter"])].slice(0,8).map(a=>(0,b.jsx)("button",{onClick:()=>{l.includes(a)||(m([...l,a]),u(`Added ${a}. Anything else?`))},className:"px-4 py-2 bg-white border border-[#dce5cc] rounded-full text-[#536538] text-sm hover:bg-[#f8faf5] transition",children:a},a))})]})]})]}):(0,b.jsx)("main",{className:"min-h-screen bg-[#fdfcf9] flex items-center justify-center px-6",children:(0,b.jsxs)("div",{className:"max-w-md w-full bg-white rounded-3xl p-8 border border-[#eef2e6] shadow-sm text-center",children:[(0,b.jsx)("div",{className:"w-14 h-14 bg-[#9caf88] rounded-full flex items-center justify-center mx-auto mb-4 olive-pulse",children:(0,b.jsx)("span",{className:"text-white text-2xl",children:"ðŸ«’"})}),(0,b.jsx)("h2",{className:"text-xl font-medium text-[#2d3a1f] mb-2",children:"Olive isn't configured yet"}),(0,b.jsx)("p",{className:"text-[#536538] text-sm mb-5",children:"Add Supabase keys to finish setup, then refresh this page."}),(0,b.jsxs)("div",{className:"bg-[#f8faf5] rounded-2xl p-4 text-left text-xs text-[#536538]",children:[(0,b.jsx)("p",{className:"font-medium text-[#2d3a1f] mb-2",children:"Required env vars"}),(0,b.jsx)("p",{children:"NEXT_PUBLIC_SUPABASE_URL"}),(0,b.jsx)("p",{children:"NEXT_PUBLIC_SUPABASE_ANON_KEY"})]}),(0,b.jsx)(f.default,{href:"/",className:"inline-flex items-center gap-2 mt-6 text-[#87a05a] hover:text-[#6b8245] text-sm",children:"Back to home"})]})})}function h(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen bg-[#fdfcf9] flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-12 h-12 bg-[#9caf88] rounded-full flex items-center justify-center olive-pulse",children:(0,b.jsx)("span",{className:"text-white text-xl",children:"ðŸ«’"})})}),children:(0,b.jsx)(g,{})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__650d207b._.js.map